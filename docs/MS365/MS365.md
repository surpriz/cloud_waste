# üìä CloudWaste - Microsoft 365 (MS365) Resources Inventory

**Status:** üöß Phase 1 - Partially Implemented (SharePoint & OneDrive 10/140 scenarios)
**Total Resources:** 14 ressources Microsoft 365 SaaS
**Total Scenarios:** 140 sc√©narios de gaspillage (14 √ó 10 = 100% coverage per resource)
**Estimated Annual Savings:** $20,000 - $100,000 (organization 500-2000 users)

---

## üìã Table des Mati√®res

1. [Vue d'Ensemble](#vue-densemble)
2. [MS365 vs Azure : Diff√©rences Critiques](#ms365-vs-azure--diff√©rences-critiques)
3. [Tableau R√©capitulatif Complet](#tableau-r√©capitulatif-complet)
4. [D√©tail par Cat√©gorie](#d√©tail-par-cat√©gorie)
5. [Microsoft Graph API](#microsoft-graph-api)
6. [Permissions Requises](#permissions-requises)
7. [Roadmap d'Impl√©mentation](#roadmap-dimpl√©mentation)

---

## üéØ Vue d'Ensemble

**Microsoft 365** (anciennement Office 365) est une suite SaaS de productivit√© et collaboration, **PAS** une plateforme cloud infrastructure comme Azure/AWS/GCP.

### MS365 = SaaS (Software as a Service)
- **Applications cloud:** SharePoint, Teams, Exchange, Power BI
- **Mod√®le pricing:** Per-user subscription ($6-57/user/mois)
- **API:** Microsoft Graph API (REST)
- **Authentication:** Azure AD / Entra ID (App Registration)

### Azure = IaaS/PaaS (Infrastructure/Platform as a Service)
- **Infrastructure cloud:** VMs, Disks, Networking, Databases
- **Mod√®le pricing:** Pay-as-you-go (usage-based)
- **API:** Azure Resource Manager API (REST)
- **Authentication:** Service Principal

### ‚ö†Ô∏è Important : Credentials S√©par√©s !
- **MS365** n√©cessite un **Entra ID App Registration** avec Microsoft Graph permissions
- **Azure** n√©cessite un **Azure Service Principal** avec Azure Resource Manager permissions
- Les deux utilisent le m√™me tenant Azure AD mais des APIs diff√©rentes

---

## üÜö MS365 vs Azure : Diff√©rences Critiques

| Aspect | Microsoft 365 (MS365) | Azure (Cloud IaaS/PaaS) |
|--------|----------------------|------------------------|
| **Type de service** | SaaS (applications m√©tier) | IaaS/PaaS (infrastructure) |
| **Exemples** | SharePoint, Teams, Exchange, Power BI | VMs, Disks, SQL Database, Storage Accounts |
| **Use Cases** | Collaboration, productivit√©, BI | H√©bergement apps, databases, compute |
| **API** | Microsoft Graph API | Azure Resource Manager API |
| **Endpoint** | `graph.microsoft.com` | `management.azure.com` |
| **Pricing** | Per-user ($6-57/mois) | Pay-as-you-go (usage) |
| **Storage inclus** | 1 TB/user (OneDrive/SharePoint) | $0.015-$0.20/GB/mois (payant) |
| **Gaspillage type** | Licences non utilis√©es, storage abandonn√© | VMs stopped, disques unattached |
| **Detection** | Graph API activity reports | Azure Monitor metrics |
| **√âconomies** | $6-57/user + $0.20/GB storage | $10-500/resource/mois |
| **Authentification** | App Registration (Graph permissions) | Service Principal (ARM permissions) |

### Exemple Concret:

**Sc√©nario 1 : Fichiers SharePoint abandonn√©s (MS365)**
- **Service:** SharePoint Online (Microsoft 365)
- **API:** `GET https://graph.microsoft.com/v1.0/sites/{site-id}/drive/items`
- **Waste:** Fichiers >100 MB non consult√©s depuis 180 jours
- **Cost:** $0.20/GB/mois (add-on storage au-del√† de 1 TB/user)
- **√âconomie:** $500-2000/an (500 GB nettoy√©s)

**Sc√©nario 2 : Disques Azure non attach√©s (Azure)**
- **Service:** Azure Managed Disks (Azure IaaS)
- **API:** `GET https://management.azure.com/subscriptions/{sub}/providers/Microsoft.Compute/disks`
- **Waste:** Disques Premium SSD non attach√©s >7 jours
- **Cost:** $0.175/GB/mois (Premium SSD)
- **√âconomie:** $10,000-30,000/an (100 disques √ó 500 GB)

üí° **Key Takeaway:** MS365 et Azure sont DEUX produits Microsoft distincts avec APIs, pricing, et use cases diff√©rents !

---

## üìä Tableau R√©capitulatif Complet

| ID | Cat√©gorie | Ressource MS365 | √âquivalent AWS | √âquivalent Azure | Sc√©narios | Priorit√© | Co√ªt/User ou Add-on | Impact/An | Status |
|----|-----------|----------------|----------------|-----------------|-----------|----------|---------------------|-----------|--------|
| **COLLABORATION & STORAGE (4 resources)** |
| 1 | Collaboration | **SharePoint Online Sites** | S3 | SharePoint (Azure) | 10 | üî¥ Critical | $0.20/GB add-on | $10K-40K | Partial (5/10) |
| 2 | Collaboration | **OneDrive for Business** | S3 | OneDrive (Azure) | 10 | üî¥ Critical | $0.20/GB add-on | $8K-30K | Partial (5/10) |
| 3 | Collaboration | **Microsoft Teams** | - | Teams (Azure) | 10 | üü° High | $0.20/GB add-on | $5K-25K | Not Started |
| 4 | Collaboration | **Microsoft 365 Groups** | - | Groups (Azure) | 10 | üü¢ Medium | $0.20/GB add-on | $3K-15K | Not Started |
| **COMMUNICATION (2 resources)** |
| 5 | Communication | **Exchange Online Mailboxes** | - | Exchange Server | 10 | üî¥ Critical | $6-57/user | $15K-60K | Not Started |
| 6 | Communication | **Yammer / Viva Engage** | - | Yammer (Azure) | 10 | üü¢ Low | $0 (included) | $1K-5K | Not Started |
| **POWER PLATFORM (3 resources)** |
| 7 | Power Platform | **Power BI Workspaces** | QuickSight | Power BI Embedded | 10 | üü° High | $10/user (Pro) | $5K-30K | Not Started |
| 8 | Power Platform | **Power Apps** | - | Logic Apps | 10 | üü¢ Medium | $15-40/user | $3K-20K | Not Started |
| 9 | Power Platform | **Power Automate Flows** | Step Functions | Logic Apps | 10 | üü¢ Medium | $15-40/user | $3K-20K | Not Started |
| **CONTENT SERVICES (3 resources)** |
| 10 | Content | **Microsoft Stream** | S3 + CloudFront | Media Services | 10 | üü¢ Medium | $0.20/GB add-on | $2K-12K | Not Started |
| 11 | Content | **Microsoft Forms** | - | - | 10 | üü¢ Low | $0 (included) | $500-3K | Not Started |
| 12 | Content | **Microsoft Planner** | - | DevOps Boards | 10 | üü¢ Low | $0 (included) | $1K-5K | Not Started |
| **LICENSING & GOVERNANCE (2 resources)** |
| 13 | Licensing | **Microsoft 365 Licenses** | Billing | Azure Subscriptions | 10 | üî¥ Critical | $6-57/user | $20K-80K | Not Started |
| 14 | Governance | **User Accounts (Inactive)** | IAM Users | Azure AD Users | 10 | üî¥ Critical | $6-57/user | $15K-70K | Not Started |

### L√©gende Priorit√©:
- üî¥ **Critical** - Impact financier majeur (>$15K/an) ou compliance/security
- üü° **High** - Impact important ($5K-15K/an)
- üü¢ **Medium/Low** - Impact mod√©r√© (<$5K/an) mais volume utilisateurs

---

## üîç D√©tail par Cat√©gorie

### 1Ô∏è‚É£ COLLABORATION & STORAGE (4 ressources) - $26K-110K/an potentiel

#### 1.1 SharePoint Online Sites - 10 sc√©narios
**Type:** SaaS - Plateforme de collaboration d'√©quipe
**API:** Microsoft Graph API `/sites`, `/drives`
**Inclus:** 1 TB/organization + 10 GB/user
**Add-on pricing:** $0.20/GB/mois au-del√† du quota

**Sc√©narios de gaspillage:**
1. **Large Files Unused** - Fichiers >100 MB non consult√©s 180+ jours
2. **Duplicate Files** - Fichiers avec hash identique (duplicatas)
3. **Abandoned Sites** - Sites avec 0 activit√© 180+ jours
4. **Excessive Versioning** - >100 versions par fichier
5. **Old Recycle Bin** - Items en corbeille >30 jours
6. **Unused Document Libraries** - Biblioth√®ques vides 90+ jours
7. **Over-Shared External Links** - Liens publics jamais acc√©d√©s
8. **Deprecated Workflows** - SharePoint 2013 workflows (obsol√®te)
9. **Large Lists Without Indexes** - Listes >5000 items sans index (perf)
10. **Sites Without Owners** - Propri√©taire parti, site orphelin

**Pricing:**
- Storage inclus: **1 TB/organization + 10 GB/user** (gratuit)
- Add-on storage: **$0.20/GB/mois** au-del√†
- Example: Organisation 500 users = 1 TB + 5 GB = 1.005 TB inclus gratuit

**Impact:** Organisation avec 50 sites abandonn√©s √ó 20 GB = 1 TB add-on ‚Üí **$2,400/an** gaspill√©s

**Status:** ‚úÖ **Partial (5/10 scenarios implemented)**
- Impl√©ment√©: Large files, Duplicates, Abandoned sites, Excessive versions, Recycle bin
- Manquant: Unused libraries, External links, Workflows, Lists, Orphaned sites

---

#### 1.2 OneDrive for Business - 10 sc√©narios
**Type:** SaaS - Stockage personnel utilisateurs
**API:** Microsoft Graph API `/users/{user-id}/drive`
**Inclus:** 1 TB/user
**Add-on pricing:** $0.20/GB/mois au-del√†

**Sc√©narios de gaspillage:**
1. **Large Files Unused** - Fichiers >50 MB non consult√©s 180+ jours
2. **Disabled Users Storage** - OneDrive de comptes d√©sactiv√©s (30+ jours)
3. **Temp Files Accumulated** - Fichiers temporaires (.tmp, .bak) accumul√©s
4. **Excessive External Sharing** - Partages externes jamais acc√©d√©s
5. **Duplicate Attachments** - Pi√®ces jointes Outlook dupliqu√©es dans OneDrive
6. **Old Backup Folders** - Folders "Backup 2022" jamais consult√©s
7. **Camera Roll Sync** - Photos t√©l√©phone synchronis√©es automatiquement (non professionnel)
8. **Desktop Sync Waste** - Dossier Desktop entier synchronis√© (100+ GB)
9. **Recycle Bin Retention** - Corbeille jamais vid√©e (>90 jours)
10. **Inactive Users >1 Year** - Utilisateurs sans login 365+ jours (license + storage waste)

**Pricing:**
- Storage inclus: **1 TB/user** (gratuit dans license M365)
- Add-on storage: **$0.20/GB/mois**
- Licence utilisateur: **$6-57/user/mois** (si inactif)

**Impact:** 50 utilisateurs d√©sactiv√©s √ó 500 GB avg = 25 TB ‚Üí **$60,000/an** (storage + licenses)

**Status:** ‚úÖ **Partial (5/10 scenarios implemented)**
- Impl√©ment√©: Large files, Disabled users, Temp files, Excessive sharing, Duplicate attachments
- Manquant: Backup folders, Camera roll, Desktop sync, Recycle bin, Inactive users

---

#### 1.3 Microsoft Teams - 10 sc√©narios
**Type:** SaaS - Plateforme de collaboration (chat, meetings, files)
**API:** Microsoft Graph API `/teams`, `/channels`
**Storage:** Files stored in SharePoint (m√™me quota)
**Add-on pricing:** $0.20/GB/mois (au-del√† quota SharePoint)

**Sc√©narios de gaspillage:**
1. **Abandoned Teams** - Teams avec 0 messages/activit√© 90+ jours
2. **Teams with <3 Members** - Teams cr√©√©s mais presque vides
3. **Large Channel Files Unused** - Fichiers >50 MB jamais consult√©s 180+ jours
4. **Excessive Channels** - >50 channels mais 80% inactifs
5. **Guest Users Inactive** - Utilisateurs externes inactifs 180+ jours
6. **Meeting Recordings Never Watched** - Enregistrements >6 mois jamais consult√©s
7. **Apps Installed But Unused** - Apps Teams install√©es mais 0 usage 90+ jours
8. **Private Channels (1 Member)** - Channels priv√©s avec 1 seul membre (overhead)
9. **Duplicate Teams** - Teams avec noms/objectifs identiques
10. **Teams Without Owners** - Propri√©taire parti, team orpheline

**Pricing:**
- Teams inclus dans M365 license
- Storage: M√™me quota SharePoint ($0.20/GB add-on)
- Meeting recordings: OneDrive/SharePoint storage

**Impact:** 100 teams abandonn√©s √ó 10 GB fichiers = 1 TB ‚Üí **$2,400/an** + management overhead

**Status:** ‚ùå **Not Started (0/10)**

---

#### 1.4 Microsoft 365 Groups - 10 sc√©narios
**Type:** SaaS - Groupes de s√©curit√© et distribution
**API:** Microsoft Graph API `/groups`
**Storage:** SharePoint + Exchange (m√™me quotas)

**Sc√©narios de gaspillage:**
1. **Empty Groups** - Groupes cr√©√©s mais 0 membres
2. **Groups with No Activity** - 0 messages/files 180+ jours
3. **Duplicate Groups** - M√™me nom/membres/objectif
4. **Groups Without Owners** - Propri√©taire parti
5. **Unused Distribution Lists** - Listes de distribution jamais utilis√©es
6. **Guest-Only Groups** - Groupes uniquement utilisateurs externes (security risk)
7. **Excessive Nested Groups** - Groupes imbriqu√©s >5 niveaux (maintenance nightmare)
8. **Groups with Expired Policies** - Expiration policies pas appliqu√©es
9. **SharePoint Group Sites Unused** - Site SharePoint du groupe abandonn√©
10. **Mailbox Quota Exceeded** - Bo√Æte partag√©e du groupe pleine (100% quota)

**Pricing:**
- Groups inclus dans M365 license
- Storage: SharePoint/Exchange quotas

**Impact:** 50 groupes abandonn√©s √ó 5 GB = 250 GB ‚Üí **$600/an** + management overhead

**Status:** ‚ùå **Not Started (0/10)**

---

### 2Ô∏è‚É£ COMMUNICATION (2 ressources) - $16K-65K/an potentiel

#### 2.1 Exchange Online Mailboxes - 10 sc√©narios
**Type:** SaaS - Email, calendrier, contacts
**API:** Microsoft Graph API `/users/{user}/mailFolders`, `/mailboxSettings`
**Inclus:** 50 GB/mailbox (100 GB pour E3/E5)
**License:** $6-57/user/mois

**Sc√©narios de gaspillage:**
1. **Inactive User Mailboxes** - Utilisateurs sans login 90+ jours (license waste)
2. **Shared Mailboxes Unused** - Bo√Ætes partag√©es 0 messages/acc√®s 180+ jours
3. **Large Attachments** - Emails avec pi√®ces jointes >10 MB (devrait utiliser OneDrive links)
4. **Old Sent Items** - Dossier "√âl√©ments envoy√©s" >10 GB (>2 ans)
5. **Archive Mailboxes Unused** - Archive mailbox activ√©e mais jamais acc√©d√©e
6. **Distribution Lists Unused** - Listes de distribution 0 messages 365+ jours
7. **Resource Mailboxes Idle** - Salles de r√©union jamais r√©serv√©es
8. **Retention Policies Missing** - Aucune politique de r√©tention configur√©e
9. **Calendar Subscriptions Broken** - Abonnements calendrier cass√©s (404 errors)
10. **Mailbox Quota Wasted** - Utilisateurs avec 5% quota utilis√© mais 50 GB allou√©s

**Pricing:**
- M365 Business Basic: **$6/user/mois** (mailbox incluse)
- M365 E3: **$36/user/mois**
- M365 E5: **$57/user/mois**

**Impact:** 50 utilisateurs inactifs √ó $36/mois = **$21,600/an** gaspill√©s en licenses seules

**Status:** ‚ùå **Not Started (0/10)**

---

#### 2.2 Yammer / Viva Engage - 10 sc√©narios
**Type:** SaaS - R√©seau social d'entreprise
**API:** Microsoft Graph API (Yammer API deprecated ‚Üí Graph migration)
**Inclus:** Gratuit dans M365 licenses

**Sc√©narios de gaspillage:**
1. **Inactive Communities** - Communaut√©s 0 posts 180+ jours
2. **Communities with <5 Members** - Communaut√©s presque vides
3. **Duplicate Communities** - M√™me nom/objectif
4. **External Users Inactive** - Guests externes inactifs 365+ jours
5. **Old Posts Never Deleted** - Posts >2 ans jamais archiv√©s
6. **Large File Uploads** - Fichiers >50 MB upload√©s (devrait utiliser SharePoint)
7. **Communities Without Moderators** - Aucun mod√©rateur assign√©
8. **Announcement-Only Communities Idle** - Communaut√©s annonces seules, 0 annonces 6+ mois
9. **Private Communities (1 Member)** - Communaut√©s priv√©es avec 1 seul membre
10. **Viva Engage Not Adopted** - Migration Yammer ‚Üí Viva Engage incompl√®te

**Pricing:**
- Inclus gratuitement dans M365 licenses
- Pas de co√ªt direct (mais storage overhead si fichiers upload√©s)

**Impact:** Faible ($1K-5K/an management overhead)

**Status:** ‚ùå **Not Started (0/10)**

---

### 3Ô∏è‚É£ POWER PLATFORM (3 ressources) - $11K-70K/an potentiel

#### 3.1 Power BI Workspaces - 10 sc√©narios
**Type:** SaaS - Business Intelligence, dashboards, rapports
**API:** Power BI REST API `/workspaces`, `/datasets`
**License:** Power BI Pro: **$10/user/mois**, Premium: **$4,995/capacity/mois**

**Sc√©narios de gaspillage:**
1. **Unused Workspaces** - Workspaces avec 0 acc√®s rapports 90+ jours
2. **Old Datasets Never Refreshed** - Datasets pas rafra√Æchis 180+ jours
3. **Reports Never Viewed** - Rapports cr√©√©s mais 0 vues 90+ jours
4. **Duplicate Datasets** - M√™mes donn√©es sources import√©es 5+ fois
5. **Pro Licenses Unused** - Utilisateurs Pro sans rapports publi√©s/consult√©s
6. **Premium Capacity Idle** - Premium capacity <10% utilisation
7. **Large Datasets Unoptimized** - Datasets >1 GB sans compression/aggregations
8. **Scheduled Refreshes Failed** - Refreshes √©chouant depuis 30+ jours
9. **Dashboards Abandoned** - Dashboards cr√©√©s mais 0 vues 6+ mois
10. **Guest Users with Pro** - Utilisateurs externes avec license Pro (rarely needed)

**Pricing:**
- Power BI Pro: **$10/user/mois** (publish & share reports)
- Power BI Premium Per User: **$20/user/mois**
- Power BI Premium Capacity: **$4,995/capacity/mois** (P1)

**Impact:** 50 users Power BI Pro inutilis√©s = $500/mois ‚Üí **$6,000/an**

**Status:** ‚ùå **Not Started (0/10)**

---

#### 3.2 Power Apps - 10 sc√©narios
**Type:** SaaS - Low-code application development
**API:** Power Platform API `/apps`, `/connections`
**License:** Per-app: **$5/user/app/mois**, Per-user: **$20/user/mois**

**Sc√©narios de gaspillage:**
1. **Apps Never Launched** - Apps cr√©√©es mais 0 lancements 90+ jours
2. **Dev/Test Apps in Production** - Apps de test non supprim√©es
3. **Unused Connectors** - Connections Premium configur√©es mais jamais utilis√©es
4. **Duplicate Apps** - M√™mes fonctionnalit√©s/objectifs
5. **Apps with No Users** - Apps partag√©es mais 0 utilisateurs actifs
6. **Old App Versions** - >10 versions sauvegard√©es (storage overhead)
7. **Premium Connectors Unused** - Connectors premium payants mais 0 usage
8. **Canvas Apps vs Model-Driven** - Canvas app complexe (devrait √™tre Model-driven)
9. **Apps Without Governance** - Aucun owner/business justification
10. **Trial Environments Not Cleaned** - Environnements de trial expir√©s

**Pricing:**
- Per-app plan: **$5/user/app/mois**
- Per-user plan: **$20/user/mois** (unlimited apps)
- Premium connectors: Inclus dans Per-user, add-on pour Per-app

**Impact:** 20 apps abandonn√©es √ó 10 users √ó $5 = $1,000/mois ‚Üí **$12,000/an**

**Status:** ‚ùå **Not Started (0/10)**

---

#### 3.3 Power Automate Flows - 10 sc√©narios
**Type:** SaaS - Workflow automation (ancien Microsoft Flow)
**API:** Power Platform API `/flows`
**License:** Per-user: **$15/user/mois**, Per-flow: **$100/flow/mois**

**Sc√©narios de gaspillage:**
1. **Flows Never Triggered** - Flows cr√©√©s mais 0 runs 90+ jours
2. **Failed Flows Unresolved** - Flows √©chouant depuis 30+ jours (100% failure rate)
3. **Duplicate Flows** - M√™mes triggers/actions (copier-coller)
4. **Dev/Test Flows Active** - Flows de test non d√©sactiv√©s
5. **Premium Connectors Unused** - Connectors premium payants mais jamais appel√©s
6. **Inefficient Flows** - Flows avec >100 actions (devrait √™tre optimis√©/refactoris√©)
7. **Flows Without Owners** - Cr√©ateur parti, flow orphelin
8. **Per-Flow Licenses Idle** - Flows licensed Per-flow mais <1000 runs/mois (Per-user cheaper)
9. **Child Flows Unused** - Child flows cr√©√©s mais jamais appel√©s par parent
10. **Scheduled Flows Overlapping** - Flows planifi√©s avec schedules qui se chevauchent

**Pricing:**
- Per-user plan: **$15/user/mois** (unlimited flows)
- Per-flow plan: **$100/flow/mois** (5 users included)
- Premium connectors: Inclus dans plans

**Impact:** 10 flows Per-flow inutilis√©s = $1,000/mois ‚Üí **$12,000/an**

**Status:** ‚ùå **Not Started (0/10)**

---

### 4Ô∏è‚É£ CONTENT SERVICES (3 ressources) - $3.5K-20K/an potentiel

#### 4.1 Microsoft Stream - 10 sc√©narios
**Type:** SaaS - Video hosting (int√©gr√© SharePoint)
**API:** Microsoft Graph API (Stream uses SharePoint backend)
**Storage:** Compte dans quota SharePoint ($0.20/GB add-on)

**Sc√©narios de gaspillage:**
1. **Videos Never Watched** - Vid√©os >6 mois avec 0 vues
2. **Large Videos Uncompressed** - Vid√©os >1 GB non compress√©es
3. **Duplicate Videos** - M√™mes vid√©os upload√©es plusieurs fois
4. **Meeting Recordings Expired** - Enregistrements Teams >1 an (retention policy manquante)
5. **Broken Transcripts** - Transcriptions automatiques √©chou√©es (storage wasted)
6. **Videos Without Owners** - Cr√©ateur parti, vid√©o orpheline
7. **External Sharing Unused** - Vid√©os partag√©es en externe jamais acc√©d√©es
8. **Old Stream Classic Content** - Contenu Stream Classic non migr√© (deprecated)
9. **Channels Abandoned** - Channels Stream avec 0 vid√©os 180+ jours
10. **Auto-Generated Thumbnails** - Thumbnails g√©n√©r√©s automatiquement en haute r√©solution (storage waste)

**Pricing:**
- Stream inclus dans M365 licenses
- Storage: SharePoint quota ($0.20/GB add-on)

**Impact:** 500 vid√©os √ó 2 GB avg = 1 TB ‚Üí **$2,400/an**

**Status:** ‚ùå **Not Started (0/10)**

---

#### 4.2 Microsoft Forms - 10 sc√©narios
**Type:** SaaS - Formulaires et sondages
**API:** Microsoft Graph API `/me/forms`
**Inclus:** Gratuit dans M365 licenses

**Sc√©narios de gaspillage:**
1. **Forms Never Shared** - Forms cr√©√©s mais jamais partag√©s/publi√©s
2. **Forms with 0 Responses** - Forms partag√©s mais 0 r√©ponses 90+ jours
3. **Duplicate Forms** - M√™mes questions/objectifs
4. **Old Forms Not Archived** - Forms >1 an toujours actifs (inutiles)
5. **Responses Not Exported** - R√©ponses jamais export√©es/analys√©es (why collect?)
6. **Forms Without Owners** - Cr√©ateur parti, form orphelin
7. **Quiz Forms Unused** - Quiz cr√©√©s mais jamais distribu√©s
8. **Branch Logic Excessive** - Logique conditionnelle >20 branches (UX nightmare)
9. **Anonymous Forms Abused** - Forms anonymes avec spam responses
10. **Forms with Broken Links** - Liens externes dans forms cass√©s (404)

**Pricing:**
- Inclus gratuitement dans M365 licenses
- Pas de co√ªt direct

**Impact:** Tr√®s faible ($500-3K/an management overhead)

**Status:** ‚ùå **Not Started (0/10)**

---

#### 4.3 Microsoft Planner - 10 sc√©narios
**Type:** SaaS - Gestion de t√¢ches et projets l√©gers
**API:** Microsoft Graph API `/planner/plans`, `/planner/tasks`
**Inclus:** Gratuit dans M365 licenses

**Sc√©narios de gaspillage:**
1. **Plans Abandoned** - Plans avec 0 t√¢ches cr√©√©es/compl√©t√©es 180+ jours
2. **Plans with No Members** - Plans cr√©√©s mais 0 membres assign√©s
3. **Duplicate Plans** - M√™mes objectifs/tasks
4. **Tasks Never Completed** - 100% des t√¢ches en "To Do" depuis 365+ jours
5. **Buckets Without Tasks** - Buckets cr√©√©s mais vides
6. **Plans Without Owners** - Cr√©ateur parti, plan orphelin
7. **Excessive Plans per Group** - >50 plans pour 1 groupe M365 (chaos)
8. **Old Completed Plans** - Plans 100% compl√©t√©s mais jamais archiv√©s
9. **Comments Without Context** - Commentaires sur t√¢ches sans texte/fichiers (spam)
10. **Charts Never Viewed** - Plans avec graphiques configur√©s mais jamais consult√©s

**Pricing:**
- Inclus gratuitement dans M365 licenses
- Pas de co√ªt direct

**Impact:** Tr√®s faible ($1K-5K/an management overhead)

**Status:** ‚ùå **Not Started (0/10)**

---

### 5Ô∏è‚É£ LICENSING & GOVERNANCE (2 ressources) - $35K-150K/an potentiel

#### 5.1 Microsoft 365 Licenses - 10 sc√©narios
**Type:** SaaS Billing - Gestion des licences utilisateurs
**API:** Microsoft Graph API `/subscribedSkus`, `/users`
**License:** $6-57/user/mois selon plan

**Sc√©narios de gaspillage:**
1. **Unassigned Licenses** - Licences pay√©es mais non assign√©es aux utilisateurs
2. **Licenses for Disabled Users** - Utilisateurs d√©sactiv√©s avec licences actives
3. **Licenses Assigned but Never Used** - Users avec license mais 0 login 90+ jours
4. **Over-Licensed Users** - Users avec E5 mais utilisent uniquement features E3
5. **Licenses for Departed Employees** - Ex-employ√©s (>30 jours) avec licences
6. **Trial Licenses Expired** - Trials expir√©s non convertis en paid
7. **Add-on Licenses Unused** - Power BI Pro, Advanced Threat Protection non utilis√©s
8. **Duplicate Licenses** - User avec multiple licenses identiques (erreur provisioning)
9. **Guest Users with Paid Licenses** - Externes avec licenses full (should be free guest)
10. **Seasonal Users** - Users actifs 3 mois/an avec license 12 mois (consulting, interns)

**Pricing:**
- M365 Business Basic: **$6/user/mois**
- M365 Business Standard: **$12.50/user/mois**
- M365 Business Premium: **$22/user/mois**
- M365 E3: **$36/user/mois**
- M365 E5: **$57/user/mois**

**Impact:** 100 licences inutilis√©es √ó $36/mois = $3,600/mois ‚Üí **$43,200/an** üî¥

**Status:** ‚ùå **Not Started (0/10)**

---

#### 5.2 User Accounts (Inactive) - 10 sc√©narios
**Type:** SaaS Governance - Gestion des comptes utilisateurs
**API:** Microsoft Graph API `/users`, `/auditLogs/signIns`
**License:** $6-57/user/mois + storage waste

**Sc√©narios de gaspillage:**
1. **Never Signed In** - Comptes cr√©√©s mais jamais connect√©s (90+ jours)
2. **Inactive 180+ Days** - Aucun login depuis 6+ mois
3. **Inactive 365+ Days** - Aucun login depuis 1+ an (critical)
4. **Disabled Accounts Not Deleted** - Comptes d√©sactiv√©s >90 jours (devrait √™tre supprim√©)
5. **Service Accounts with Licenses** - Comptes de service avec licenses user (should be app-only)
6. **Guest Accounts Expired** - Comptes externes expir√©s >30 jours
7. **Mailbox-Only Users** - Users sans OneDrive/SharePoint activity (license downgrade opportunity)
8. **Multi-Factor Auth Disabled** - Users sans MFA >365 jours (security + compliance risk)
9. **Users Without Manager** - Hi√©rarchie organizational incompl√®te (governance)
10. **Former Employees Storage** - OneDrive/mailbox ex-employ√©s >365 jours (compliance + cost)

**Pricing:**
- License cost: **$6-57/user/mois**
- Storage cost: OneDrive 1 TB + Mailbox 50-100 GB = **1.05 TB/user**
- If exceeding quota: **$0.20/GB/mois**

**Impact:** 50 comptes inactifs √ó ($36 license + $10 storage avg) = $2,300/mois ‚Üí **$27,600/an** üî¥

**Status:** ‚ùå **Not Started (0/10)**

---

## üîå Microsoft Graph API

### Endpoint et Authentication

```bash
# Base URL
https://graph.microsoft.com/v1.0
https://graph.microsoft.com/beta  # Preview features

# Authentication
POST https://login.microsoftonline.com/{tenant}/oauth2/v2.0/token
Body:
  grant_type: client_credentials
  client_id: {app-id}
  client_secret: {app-secret}
  scope: https://graph.microsoft.com/.default
```

### APIs Requises par Ressource

| Ressource | API Endpoints | Rate Limits |
|-----------|---------------|-------------|
| **SharePoint Sites** | `/sites`, `/sites/{site-id}/drives`, `/drives/{drive-id}/items` | 2000 req/min |
| **OneDrive** | `/users/{user-id}/drive`, `/me/drive/root/children` | 2000 req/min |
| **Teams** | `/teams`, `/teams/{team-id}/channels`, `/teams/{team-id}/members` | 1000 req/min |
| **Groups** | `/groups`, `/groups/{group-id}/members`, `/groups/{group-id}/sites` | 2000 req/min |
| **Exchange** | `/users/{user-id}/mailFolders`, `/users/{user-id}/messages` | 1000 req/min |
| **Power BI** | Power BI REST API: `/workspaces`, `/datasets`, `/reports` | 200 req/min |
| **Power Platform** | Power Platform API: `/apps`, `/flows`, `/connections` | 500 req/min |
| **Licenses** | `/subscribedSkus`, `/users?$select=assignedLicenses` | 2000 req/min |
| **Users** | `/users`, `/auditLogs/signIns` | 2000 req/min |

### Python SDK

```python
# Installation
pip install msal
pip install msgraph-sdk
pip install azure-identity

# Authentication
from azure.identity import ClientSecretCredential
from msgraph import GraphServiceClient

credential = ClientSecretCredential(
    tenant_id="YOUR_TENANT_ID",
    client_id="YOUR_APP_ID",
    client_secret="YOUR_APP_SECRET"
)

graph_client = GraphServiceClient(credentials=credential)

# Example: List SharePoint sites
sites = await graph_client.sites.get()
for site in sites.value:
    print(f"Site: {site.display_name}, URL: {site.web_url}")
```

---

## üîê Permissions Requises

### Entra ID App Registration Setup

1. **Cr√©er App Registration**
```bash
# Azure Portal
1. Aller dans "Azure Active Directory" ‚Üí "App registrations"
2. Cliquer "New registration"
3. Nom: "CloudWaste-MS365-Scanner"
4. Supported account types: Single tenant
5. Redirect URI: Laisser vide (backend app)
6. Cr√©er
```

2. **Ajouter Client Secret**
```bash
1. App registration ‚Üí "Certificates & secrets"
2. "New client secret"
3. Description: "CloudWaste production"
4. Expires: 24 months (max)
5. Copier la "Value" (1 seule fois visible!)
```

3. **Configurer API Permissions**
```bash
1. App registration ‚Üí "API permissions"
2. "Add a permission" ‚Üí "Microsoft Graph" ‚Üí "Application permissions"
3. Ajouter les permissions ci-dessous
4. Cliquer "Grant admin consent" (CRITICAL!)
```

### Microsoft Graph Permissions (Application-Level)

**‚ö†Ô∏è Important:** Toutes les permissions doivent √™tre **Application permissions**, PAS Delegated !

| Permission | Type | Justification |
|------------|------|---------------|
| **Files & Storage** |
| `Files.Read.All` | Application | Lire SharePoint/OneDrive files |
| `Sites.Read.All` | Application | Lister sites SharePoint |
| **Users & Directory** |
| `User.Read.All` | Application | Lister users, check activity |
| `Directory.Read.All` | Application | Lire Azure AD directory info |
| `AuditLog.Read.All` | Application | Lire sign-in logs (user activity) |
| **Groups & Teams** |
| `Group.Read.All` | Application | Lister M365 Groups |
| `Team.ReadBasic.All` | Application | Lister Teams |
| `Channel.ReadBasic.All` | Application | Lister Teams channels |
| **Exchange** |
| `Mail.Read` | Application | Lire mailboxes (size, activity) |
| `MailboxSettings.Read` | Application | Lire mailbox settings |
| **Organization** |
| `Organization.Read.All` | Application | Lire tenant info, licenses |
| **Reports** |
| `Reports.Read.All` | Application | Lire usage reports |

### Power Platform API Permissions

S√©par√© de Microsoft Graph (diff√©rent endpoint):

```bash
# Power Platform Admin Center
1. Power Platform Admin Center (admin.powerplatform.microsoft.com)
2. "Data policies" ‚Üí "Connectors"
3. Configure Service Principal access
```

**Power BI REST API:**
- Endpoint: `https://api.powerbi.com/v1.0/myorg`
- Auth: Azure AD token with scope `https://analysis.windows.net/powerbi/api/.default`
- Permissions: "Power BI Service" app registration

**Power Apps / Power Automate:**
- Endpoint: `https://api.flow.microsoft.com` (Power Automate)
- Endpoint: `https://api.powerapps.com` (Power Apps)
- Auth: Azure AD token with Power Platform scopes

---

## üóìÔ∏è Roadmap d'Impl√©mentation

### **Phase 1 : SharePoint & OneDrive Completion (2-3 semaines)**
**Objectif:** Compl√©ter les 10/10 sc√©narios SharePoint + OneDrive

| Semaine | T√¢che | Livrables |
|---------|-------|-----------|
| 1 | Compl√©ter SharePoint 5 sc√©narios manquants | 10/10 SharePoint ‚úÖ |
| 2 | Compl√©ter OneDrive 5 sc√©narios manquants | 10/10 OneDrive ‚úÖ |
| 3 | Tests end-to-end, optimisation perf | SharePoint + OneDrive 100% |

**Livrable Phase 1:** 2 ressources, 20 sc√©narios, $18K-70K/an √©conomies

---

### **Phase 2 : Licensing & Governance (2-3 semaines)**
**Objectif:** Highest ROI - Licences et utilisateurs inactifs

| Semaine | Ressources | Raison Priorit√© |
|---------|-----------|-----------------|
| 4 | **M365 Licenses** (10 scenarios) | ROI maximal: $20K-80K/an |
| 5 | **User Accounts Inactive** (10 scenarios) | $15K-70K/an + security |
| 6 | Tests, dashboards, alerting | Licenses + Users 100% |

**Livrable Phase 2:** 4 ressources, 40 sc√©narios, $53K-220K/an √©conomies cumul√©es

---

### **Phase 3 : Collaboration (3-4 semaines)**
**Objectif:** Teams, Groups, Exchange

| Semaine | Ressources | Raison Priorit√© |
|---------|-----------|-----------------|
| 7-8 | **Microsoft Teams** (10 scenarios) | High usage, storage waste |
| 9 | **M365 Groups** (10 scenarios) | Fondamental pour Teams/SharePoint |
| 10 | **Exchange Online** (10 scenarios) | Critical, license waste |

**Livrable Phase 3:** 7 ressources, 70 sc√©narios, $74K-330K/an √©conomies cumul√©es

---

### **Phase 4 : Power Platform (3-4 semaines)**
**Objectif:** Power BI, Power Apps, Power Automate

| Semaine | Ressources | Raison Priorit√© |
|---------|-----------|-----------------|
| 11-12 | **Power BI** (10 scenarios) | Add-on licenses expensive |
| 13 | **Power Apps** (10 scenarios) | Per-app/per-user waste |
| 14 | **Power Automate** (10 scenarios) | Per-flow licenses expensive |

**Livrable Phase 4:** 10 ressources, 100 sc√©narios, $85K-400K/an √©conomies cumul√©es

---

### **Phase 5 : Content Services (2 semaines)**
**Objectif:** Compl√©ter couverture 100%

| Semaine | Ressources | Raison Priorit√© |
|---------|-----------|-----------------|
| 15 | **Stream, Forms, Planner, Yammer** (40 scenarios) | Low cost but completeness |

**Livrable Phase 5:** 14 ressources, 140 sc√©narios, $89K-420K/an √©conomies cumul√©es

---

## üí∞ Impact Financier Estim√©

### Par Taille d'Organisation:

| Taille | Users | M365 Spend/Mois | Waste Detect√© | √âconomies/An | ROI CloudWaste |
|--------|-------|-----------------|---------------|--------------|----------------|
| **Startup (10-50)** | 25 | $900 ($36/user E3) | 15-25% | **$1,620-2,700** | 5-10x |
| **PME (50-200)** | 150 | $5,400 | 20-30% | **$12,960-19,440** | 20-40x |
| **Moyenne (200-500)** | 350 | $12,600 | 25-35% | **$37,800-52,920** | 50-100x |
| **Entreprise (500-2000)** | 1,000 | $36,000 | 30-40% | **$129,600-172,800** | 100-200x |
| **Grande (2000+)** | 5,000 | $180,000 | 35-50% | **$756,000-1,080,000** | 200-500x |

### Breakdown par Type de Gaspillage (Org 1000 users):

| Type | % Users | Impact/An | Priority |
|------|---------|-----------|----------|
| **Licences non assign√©es** | 5% (50 users) | **$21,600** | üî¥ Critical |
| **Utilisateurs inactifs** | 10% (100 users) | **$43,200** | üî¥ Critical |
| **Storage add-on (SharePoint/OneDrive)** | 5 TB | **$12,000** | üü° High |
| **Power BI Pro inutilis√©** | 5% (50 users) | **$6,000** | üü° High |
| **Exchange mailboxes inactives** | 5% (50 users) | **$21,600** | üî¥ Critical |
| **Teams/Groups abandonn√©s** | Storage | **$3,000** | üü¢ Medium |
| **Power Apps/Automate inutilis√©s** | 20 apps/flows | **$12,000** | üü° High |
| **Autres (Stream, Forms, etc.)** | - | **$5,000** | üü¢ Low |
| **TOTAL** | | **~$124,400/an** | |

---

## üéØ Conclusion

Ce document constitue le **r√©f√©rentiel complet** pour Microsoft 365 dans CloudWaste:

- ‚úÖ **14 ressources MS365** identifi√©es et document√©es
- ‚úÖ **140 sc√©narios** de gaspillage (10 par ressource)
- ‚úÖ **Microsoft Graph API** et permissions requises
- ‚úÖ **Roadmap** d'impl√©mentation en 5 phases
- ‚úÖ **ROI estim√©** : $20K-$100K/an √©conomies (organisation 500-2000 users)

**Diff√©rences critiques MS365 vs Azure:**
- MS365 = SaaS (SharePoint, Teams, Exchange)
- Azure = IaaS/PaaS (VMs, Disks, SQL)
- APIs distinctes (Graph vs ARM)
- Credentials s√©par√©s (App Registration vs Service Principal)

**Prochaines √©tapes:**
1. Valider la liste avec l'√©quipe
2. Compl√©ter SharePoint + OneDrive (Phase 1)
3. Impl√©menter Licenses + Users (Phase 2 - highest ROI)
4. Tester avec tenant M365 staging

---

**Derni√®re mise √† jour:** 2 novembre 2025
**Version:** 1.0
**Auteur:** CloudWaste Team + Claude Code
**Status:** üöß Partial Implementation - Ready to Complete
